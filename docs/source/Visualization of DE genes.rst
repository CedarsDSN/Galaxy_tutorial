Visualization of the expression of differentially expressed genes
================================================================

At this stage, we have our tables with all relevant information, including the gene annotations, normalized counts, etc. A helpful plot would be of the normalized counts for these genes for each sample with a heatmpa, using the normalized count file generated by DESeq2. One could also compute the Z-score and plot a heatmap using these scores.

For users that are running the workflow, these are the tools that would output a heatmap of the normalized counts of differentially expressed genes - "Visualization of the normalized counts" 

* Join datasets side by side on a specified field

* Cut

* heatmap2

These are the tools that would calculate a Z-score for all genes and output a heatmap for the same - "Visualization of the Z-score" - 

* Table Compute

* heatmap2

For these tools, you don't have to change any parameters or enter any values. For users running the workflow, you can read further down this page if you would like to know how the tools work and what they do (This will also show you the default parameters), or navigate to the next step.

For users running each step or running the secondary analysis seperately, let's get into the nitty-gritties of the "Visualization of the normalized counts" step -
The first tool that is used is "Join datasets side by side on a specified field"

* This tool is mainly used to join the normalized counts that was generated from DESeq2 and the table with the annotated genes with significant p-value and log2 Foldchange

* Search for this tool under "Tools"

* Under "Join", select the output generated from DESeq2 - "Normalized counts"

* Select "Column: 1" under "using column" (The first column is the Gene name)

* Under "with", select the files that was created in the earlier step - "Genes with significant adj p-value & abs(log2(FC)) > 1"

* Under "and column", select "Column: 1" (The first column here is also Gene name and hence can be used to join the two tables)

* Select "No" under "Keep lines of first input that do not join with second input"

* Select "Yes" under "Keep the header lines"

* Click on "Execute"

* The file produced will have more columns that is needed for generating the heatmap and these columns have to be removed

The second tool that is used is "Cut"

* This tool can cut columns from a table so that only certain columns are retained

* Under "Cut columns", enter "c1-c8"

* Under "Delimited by", enter "Tab"

* Select the output of "Join datasets side by side on a specified field" under "From"

* Click on "Execute"

* Rename the output to "Normalized counts for the most differentially expressed genes"

The next tool is "heatmap2"

* This tool plots the heatmap

* Search for "heatmap2" under "Tools"

* Under "Input should have column headers", enter the output of the earlier step - "Normalized counts for the most differentially expressed genes"

* Under "Data transformation", enter "Log2(value) transform my data" (You want to plot the log2 normalized counts to see the differences between the genes)

* Select "Yes" for "Enable data clustering"

* Under "Labeling columns and rows", enter "Label columns and not rows" (If you want to see sample labels and not genes)

* Select "Gradient with 2 colors" under "Type of colormap to use"

* Click on "Execute"

Visualization of the Z-score
================================

For the steps to generate the heatmap for "Visualization of the Z-score" -

* The first tool that is used is "Table compute" and is not required to plot the heatmap but is provided here to understand how Z-scores are generated
Table Compute tool helps compute Z-score and is done in 2 steps

* Subtract each value by the mean of values in a row using the normalized count table

* Divide the previous values by the standard deviation of values in the row, using the two tables (the normalized counts and table computed in the first step)

* Table Compute one -

  a. Under "Input Single or Multiple Tables", select "Single Table" and provide the output of DESeq2 - "Normalized counts"

  b. Under "Type of table operation", select "Perform a full table operation"

  c. Select "Custom" under "Operation"

  d. Select "Custom expression on table along 'axis' (0 or 1)" and input "table.sub(table.mean(1), 0)"

  e. The table.mean(1) expression computes the mean for each row (here the genes) and table.sub(table.mean(1), 0) substracts each value by the mean of the row (computed with table.mean(1))

  f. Click on "Execute"

* Table Compute two

  a. Under "Input Single or Multiple Tables", select "Multiple Table" and provide the output of DESeq2 - "Normalized counts"

  b. Click on "Insert Tables"

  c. In "Tables, enter the output of "Table Compute one"

  d. Select "Custom" under "Operation"

  e. Enter "Custom expression on ‘tableN’" and enter "table2.div(table1.std(1),0)"

  f. The table1.std(1) expression computes the standard deviations of each row on the 1st table (normalized counts) and table2.div divides the values of 2nd table (previously computed) by these standard deviations

  g. Click on "Execute"

  h. Rename the output to "Z-scores"

  i. The next tool used is "heatmap2"

  j. Under "Input should have column headers", enter the file- "Normalized counts for the most differentially expressed genes"

  k. Under "Data transformation", enter "Plot the data as it is"

  l. Select "Compute on rows" under "Compute z-scores prior to clustering"

  m. Select "Yes" under "Enable data clustering"

  n. Under "Labeling columns and rows", enter "Label columns and not rows" (If you want to see sample labels and not genes)

  o. Select "Gradient with 3 colors" under "Type of colormap to use"

  p. Click on "Execute"
